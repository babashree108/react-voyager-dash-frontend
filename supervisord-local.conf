[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid

[program:mysql]
command=/usr/bin/mysqld_safe
autostart=true
autorestart=true
priority=1
stdout_logfile=/var/log/mysql-stdout.log
stderr_logfile=/var/log/mysql-stderr.log
user=mysql

[program:backend]
command=java -Xmx512m -Xms256m -jar /app/backend/target/backend-0.0.1-SNAPSHOT.jar
directory=/app/backend
autostart=true
autorestart=true
priority=2
startretries=10
startsecs=10
stdout_logfile=/var/log/backend-stdout.log
stderr_logfile=/var/log/backend-stderr.log
environment=
    JWT_SECRET="nxtclass_jwt_secret_key_for_local_testing_only_minimum_256_bits_required_here",
    JWT_EXPIRATION="3600000",
    DB_URL="jdbc:mysql://localhost:3306/nxtClass108?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true",
    DB_USERNAME="nxtclass_user",
    DB_PASSWORD="nxtclass_pass_2024",
    CORS_ALLOWED_ORIGINS="http://localhost,http://127.0.0.1",
    LOG_LEVEL="INFO",
    SPRING_PROFILES_ACTIVE="dev"

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
autostart=true
autorestart=true
priority=3
stdout_logfile=/var/log/nginx-stdout.log
stderr_logfile=/var/log/nginx-stderr.log
